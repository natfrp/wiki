# SakuraFrp 启动器系统服务配置指南

SakuraFrp Launcher v2.0.0.0 后提供了切换运行模式的选项，您可以将守护进程作为系统服务运行，从而实现开机无需进入桌面即自启动 frpc 的效果

!> 仅 WPF 启动器支持切换运行模式，传统启动器只能使用守护进程模式

## 前置知识 :id=note

启动器和守护进程的区别:

+ 守护进程的功能: 进行用户登录、启动隧道、接收远程管理请求等，基本上所有功能都是它实现的  
   *对应进程 SakuraFrpService.exe*
+ 启动器的功能: 给您提供一个控制守护进程的界面  
   *对应进程 SakuraLauncher.exe 或 LegacyLauncher.exe*

简单的说，只要 `守护进程` 在运行，内网穿透就可以正常工作。`启动器` 只是用来管理 `守护进程` 的一个界面，不需要随时开着。

---

两种运行模式的区别:

 - 守护进程模式: 守护进程就是一个普通的进程，完全由启动器进行管理  
   该模式下开机自启功能受限，必须进入桌面才会启动隧道
 - 系统服务模式: 将守护进程安装为一个 [Windows 系统服务](https://baike.baidu.com/item/%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1)，同时由 Windows 系统和启动器管理  
   该模式下 Windows 开机时就会启动守护进程，无需进入桌面就能自启各个隧道，**可满足重启后通过 frp 连接远程桌面等需求**

简单的说，如果您需要系统重启后不登录、不进入桌面就开启隧道，请安装系统服务。如果您没有这种需求，就不需要安装系统服务。

## 安装服务 :id=install

如果您正在安装启动器，直接按下图勾选 `安装为系统服务` 和 `WPF 界面` 并完成安装即可：

![](_images/service-0.png?v=1)

---

如果启动器已经装好了，您可以选择直接进行一次覆盖安装，也可以按下面的步骤操作：

!> 如果您使用的是 "绿色版" 启动器，请直接删除当前的启动器并使用安装包安装为系统服务，不要使用下面的方法

1. 退出登录，然后点击 `安装服务` 按钮

   ![](_images/service-1.png?v=1)

2. 阅读操作说明，然后点击确认继续操作

   ![](_images/service-2.png?v=1)

3. 系统会弹出 UAC 提示框，点击 **是**

   ![](_images/service-3.png?v=1)

4. 如果一切正常，服务安装成功后启动器会自动退出，随后再打开启动器正常登录即可。此时运行模式会显示为 **系统服务**

   ?> 运行模式显示为 **系统服务** 后，**不需要** 打开 `启动器开机自启` 这个开关，开机时服务会自动启动

   ![](_images/service-4.png?v=1)

5. **普通用户不需要进行下面的操作**。如果您是高级用户，您可以在 `services.msc` 中找到 `SakuraFrp Daemon Sevice` 并对其进行自定义配置

   ![](_images/service-5.png?v=1)

## 卸载服务 :id=uninstall

!> 服务卸载可能需要数十秒时间，请耐心等待，不要强制关闭启动器，否则可能产生不可预料的后果

卸载流程和安装流程基本完全一致，请参阅上方 "启动器已经装好了" 的安装说明
